YUI.add("hermes-template-bulk-download-modal",(function(e,n){var l=e.Template.Handlebars.revive({1:function(e,n,l,a,t){var r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return e.escapeExpression((r(l,"intlMessage")||n&&r(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"downloadr.DOWNLOAD_WHEN_READY_LOGGED_OUT"},data:t,loc:{start:{line:1,column:20},end:{line:1,column:87}}}))},3:function(e,n,l,a,t){var r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return e.escapeExpression((r(l,"intlMessage")||n&&r(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"downloadr.DOWNLOAD_WHEN_READY"},data:t,loc:{start:{line:1,column:95},end:{line:1,column:151}}}))},5:function(e,n,l,a,t){var r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return e.escapeExpression((r(l,"intlMessage")||n&&r(n,"intlMessage")||e.hooks.helperMissing).call(null!=n?n:e.nullContext||{},{name:"intlMessage",hash:{intlName:"downloadr.BE_SURE_RIGHTS"},data:t,loc:{start:{line:3,column:43},end:{line:3,column:94}}}))},compiler:[8,">= 4.3.0"],main:function(e,n,l,a,t){var r,o=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"<p>"+(null!=(r=s(l,"if").call(o,null!=n?s(n,"loggedOut"):n,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.program(3,t,0),data:t,loc:{start:{line:1,column:3},end:{line:1,column:158}}}))?r:"")+'</p>\n\n<p class="copyright">'+(null!=(r=s(l,"unless").call(o,null!=n?s(n,"isOwnAlbum"):n,{name:"unless",hash:{},fn:e.program(5,t,0),inverse:e.noop,data:t,loc:{start:{line:3,column:21},end:{line:3,column:105}}}))?r:"")+"</p>\n"},useData:!0}),a={};e.Array.each([],(function(n){var l=e.Template.get("hermes/"+n);l&&(a[n]=l)})),e.Template.register("hermes/bulk-download-modal",(function(n,t){return(t=t||{}).partials=t.partials?e.merge(a,t.partials):a,l(n,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-download-tooltip",(function(n,e){var t=n.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(n,e,t,a,l){var o,r=null!=e?e:n.nullContext||{},i=n.hooks.helperMissing,c="function",s=n.escapeExpression,u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"<div>\n\t"+s(typeof(o=null!=(o=u(t,"content")||(null!=e?u(e,"content"):e))?o:i)===c?o.call(r,{name:"content",hash:{},data:l,loc:{start:{line:2,column:1},end:{line:2,column:12}}}):o)+'\n\t<br/>\n\t<br/>\n\t<a class="close-onboarding">'+s(typeof(o=null!=(o=u(t,"confirmationLink")||(null!=e?u(e,"confirmationLink"):e))?o:i)===c?o.call(r,{name:"confirmationLink",hash:{},data:l,loc:{start:{line:5,column:29},end:{line:5,column:49}}}):o)+"</a>\n</div>\n"},useData:!0}),a={};n.Array.each([],(function(e){var t=n.Template.get("hermes/"+e);t&&(a[e]=t)})),n.Template.register("hermes/download-tooltip",(function(e,l){return(l=l||{}).partials=l.partials?n.merge(a,l.partials):a,t(e,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("bulk-downloader-view",(function(e,t){"use strict";e.BulkDownloaderView=e.Base.create("BulkDownloaderView",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.localizeLib=e.mix({langBundles:["common","album-page","cameraroll"],appContext:this.appContext},e.Localizable),this.set("isOwnAlbum",t.isOwnAlbum)},showLoadingDialog:function(){let t=new e.Views["confirmation-dialog-view"]({appContext:this.appContext,showCancelButton:!1,showConfirmButton:!1,htmlMessage:this.templates("flickr-balls")({isBlock:!0}),title:this.intlMessage({intlName:"cameraroll.PREPARING_DOWNLOAD"})});return new e.Views.FluidModal({appContext:this.appContext,subview:t,dismissOnOverlayClick:!1,hasSubviewConfigRefactor:!0}).show()},createTitle:function(e,t){var o="";if(t=t||0,(e=e||0)>0&&t>0)o=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS_AND_VIDEO",photoCount:e,videoCount:t});else if(e>0&&0===t)o=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:e});else{if(!(0===e&&t>0))throw new Error(this.intlMessage({intlName:"cameraroll.DOWNLOAD_NOT_AVAILABLE_ERROR"}));o=this.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:t})}return o},createButtonLabel:function(e,t){var o="";return t+e>1?o=this.intlMessage({intlName:"album-page.DOWNLOAD_ZIP"}):1===e&&0===t?o=this.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:e}):0===e&&1===t&&(o=this.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:t})),o},prepareArchive:function(e){var t=this;return this.appContext.callAPI("flickr.download.archives.create",e).then((function(e){var o,i,n=e.archive.countPhotos,a=e.archive.countVideos,l=e.archive.key;return o=t.createTitle(n,a),i=t.createButtonLabel(n,a),{title:o,downloadURLs:e.archive.urls.map((function(e,t){return{url:e,partSequence:t+1}})),buttonLabel:i,key:l}})).catch((function(e){throw 105===e.code?new Error(t.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"})):new Error(t.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"}))}))},showDownloadDialog:function(t){var o,i,n=t.title,a=this;t.downloadURLs;(o=t.setID?{set_id:t.setID}:t.share_code?{share_code:t.share_code,gp_code:t.gp_code,gp_owner:t.gp_owner}:{photo_ids:t.photoIDs,owner_id:t.ownerID}).extras="offline_enabled";let l=new e.Views["confirmation-dialog-view"]({appContext:this.appContext,title:n,confirmButtonText:this.intlMessage({intlName:"downloadr.CREATE_ZIP"}),htmlMessage:this.templates("bulk-download-modal")({isOwnAlbum:this.get("isOwnAlbum"),loggedOut:!this.appContext.getViewer().signedIn}),onConfirm:()=>(l.setLoading(!0),this.prepareArchive(o).then((e=>{i.close(),this.appContext.getViewer().signedIn?this.showTooltip(e.key):this.appContext.flapp.navigate("/download/"+e.key)})).catch((t=>{i.close(),105===t.code?this.onError(new Error(a.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"})),i):(e.config.win.beaconError("[bulk-download] Error creating archive ",e.config.win.location.href,t),this.onError(new Error(a.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"})),i))})))});return i=new e.Views.FluidModal({appContext:this.appContext,subview:l,hasSubviewConfigRefactor:!0}).show()},onError:function(t,o){o&&o.close();let i=new e.Views["confirmation-dialog-view"]({appContext:this.appContext,showCancelButton:!1,htmlMessage:t.message,title:this.intlMessage({intlName:"common.ERROR"})});new e.Views.FluidModal({appContext:this.appContext,subview:i,hasSubviewConfigRefactor:!0}).show()},showTooltip:function(t){var o=e.one(".global-nav-view").one(".notifications-menu-view"),i=this;if(o){this.tooltip=new e.Views.FluidDroparound({appContext:this.appContext,htmlMessage:this.templates("download-tooltip")({content:this.intlHTMLMessage({intlName:"downloadr.TOOLTIP_DOWNLOAD_LINK_MESSAGE",url:"/download/"+t}),confirmationLink:this.intlMessage({intlName:"downloadr.TOOLTIP_OK"})}),showDropArrow:!0,dismissOnOverlayClick:!0,observePageResize:!0,anchorElement:o,keyboardAnchorElement:o,minVerticalSpace:400,width:350,positionFixed:!0,preferLeft:!0,closeOnScroll:!0,anchorOffsetVertical:0});var n=this.tooltip.get("container");i.registerEventHandler(n.delegate("click",(function(e){e.preventDefault(),i.tooltip.close()}),".close-onboarding")),this.tooltip.show()}}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","hermes-template-bulk-download-modal","hermes-template-download-tooltip","hermes-template-flickr-balls"],langBundles:["common","downloadr","album-page","cameraroll"],optional:[],affinity:"client"});YUI.add("html-file-dragdrop",(function(e){"use strict";var r="htmlFileDragDrop",o=r+"-drag-over",t=r+"-error",i=["image/png","image/jpeg"];e.HtmlFileDragDrop=function(r){e.config.win.File&&e.config.win.FileList&&e.config.win.FileReader&&r.dropZone&&(this.dropZone=e.one(r.dropZone),this.dropZone.on("dragover",this.handleDragOver.bind(this)),this.dropZone.on("dragleave",this.handleDragLeave.bind(this)),this.dropZone.on("drop",this.handleDrop.bind(this)))},e.HtmlFileDragDrop.prototype.reset=function(){this.dropZone.removeClass(t),this.dropZone.removeClass(o)},e.HtmlFileDragDrop.prototype.handleDragOver=function(e){e.halt(),this.reset(),this.dropZone.addClass(o)},e.HtmlFileDragDrop.prototype.handleDragLeave=function(e){e.halt(),this.reset()},e.HtmlFileDragDrop.prototype.showError=function(){this.dropZone.addClass(t)},e.HtmlFileDragDrop.prototype.handleDrop=function(e){var r;if(e.halt(),this.dropZone.removeClass(o),e._event.dataTransfer.files.length>1)return this.dropZone.addClass(t),void this.fire("drop",new Error("FILE_COUNT"));if((r=e._event.dataTransfer.files[0])&&r.name){if(i.indexOf(r.type)<0)return void this.fire("drop",new Error("FILE_TYPE"));this.fire("drop",r)}},e.augment(e.HtmlFileDragDrop,e.EventTarget,!0,null,{prefix:r})}),"@VERSION@",{affinity:"",requires:["event-custom"],optional:[]});YUI.add("hermes-template-photo-selector",(function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-yours">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},3:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-contacts">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},5:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-everyone">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},7:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-marketplace"\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},9:function(t,n,e,l,a){var s,o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div class="photo-selector-upload is-hiding">\n'+(null!=(s=o(e,"if").call(null!=n?n:t.nullContext||{},null!=n?o(n,"canUpload"):n,{name:"if",hash:{},fn:t.program(10,a,0),inverse:t.program(12,a,0),data:a,loc:{start:{line:58,column:1},end:{line:76,column:8}}}))?s:"")+"</div>\n"},10:function(t,n,e,l,a){var s=null!=n?n:t.nullContext||{},o=t.hooks.helperMissing,i=t.escapeExpression,c=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t<p class="upload-error"></p>\n\t\t<div class="drop-zone">\n\t\t\t<div class="drop-zone-content">\n\t\t\t\t<div class="balls"></div>\n\t\t\t\t<input type="file" class="file-select" name="file-select" accept="image/jpeg, image/png" />\n\t\t\t\t<p><i class="upload-icon"></i>'+i((c(e,"intlHTMLMessage")||n&&c(n,"intlHTMLMessage")||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"wallart.DRAG_DROP_TO_UPLOAD"},data:a,loc:{start:{line:64,column:34},end:{line:64,column:92}}}))+"</p>\n\t\t\t\t<p>"+i((c(e,"intlHTMLMessage")||n&&c(n,"intlHTMLMessage")||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"wallart.PHOTOS_UPLOADED_AS_PRIVATE"},data:a,loc:{start:{line:65,column:7},end:{line:65,column:72}}}))+'</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<ul class="preview"></ul>\n'},12:function(t,n,e,l,a){var s=null!=n?n:t.nullContext||{},o=t.hooks.helperMissing,i=t.escapeExpression,c=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t<div class="cant-upload">\n\t\t\t<div class="cant-upload-message">\n\t\t\t\t<span>'+i((c(e,"intlMessage")||n&&c(n,"intlMessage")||o).call(s,{name:"intlMessage",hash:{limitCount:(c(e,"intlNumber")||n&&c(n,"intlNumber")||o).call(s,1e3,{name:"intlNumber",hash:{},data:a,loc:{start:{line:72,column:89},end:{line:72,column:106}}}),intlName:"upload-blocking.YOUVE_REACHED_UPLOAD_LIMIT"},data:a,loc:{start:{line:72,column:10},end:{line:72,column:108}}}))+'</span>\n\t\t\t\t<a href="/account/upgrade/pro/">'+i((c(e,"intlMessage")||n&&c(n,"intlMessage")||o).call(s,{name:"intlMessage",hash:{intlName:"common.GET_PRO"},data:a,loc:{start:{line:73,column:36},end:{line:73,column:77}}}))+"</a>\n\t\t\t</div>\n\t\t</div>\n"},14:function(t,n,e,l,a){return'<div class="group-photo-selector-photos-wrapper">\n\t<div class="group-photo-selector-photos photo-selector-photos">\n\t\t<div class="group-photo-selector-photos-container">\n\t\t</div>\n\t</div>\n</div>\n'},compiler:[8,">= 4.3.0"],main:function(t,n,e,l,a){var s,o=null!=n?n:t.nullContext||{},i=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div class="photo-selector-title-bar hidden">\n\t<div class="back-to-list">\n\t\t<div class="back-to-list-icon"><svg class="icon icon-back"><use xlink:href="#icon-back"></use></svg></div>\n\t\t<div class="back-to-list-text">'+t.escapeExpression((i(e,"intlMessage")||n&&i(n,"intlMessage")||t.hooks.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"},data:a,loc:{start:{line:4,column:33},end:{line:4,column:100}}}))+'</div>\n\t</div>\n\t<div class="title"></div>\n</div>\n\n<div class="photo-selector-photos-wrapper">\n\t<div class="photo-selector-photos">\n\t\t<div class="photo-selector-photos-container">\n\t\t\t<div class="loader"><div class="balls"></div></div>\n\t\t</div>\n\t</div>\n</div>\n\n\n<div class="photo-selector-search-lists-wrapper is-hiding">\n'+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"yours"):s,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:19,column:1},end:{line:26,column:8}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"contacts"):s,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a,loc:{start:{line:28,column:1},end:{line:35,column:8}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"everyone"):s,{name:"if",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a,loc:{start:{line:37,column:1},end:{line:44,column:8}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"marketplace"):s,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a,loc:{start:{line:46,column:1},end:{line:53,column:8}}}))?s:"")+"</div>\n\n"+(null!=(s=i(e,"if").call(o,null!=n?i(n,"hasUploadCapabilities"):n,{name:"if",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a,loc:{start:{line:56,column:0},end:{line:78,column:7}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=n?i(n,"hasGroupCapabilities"):n,{name:"if",hash:{},fn:t.program(14,a,0),inverse:t.noop,data:a,loc:{start:{line:80,column:0},end:{line:87,column:7}}}))?s:"")},useData:!0}),l={};t.Array.each([],(function(n){var e=t.Template.get("hermes/"+n);e&&(l[n]=e)})),t.Template.register("hermes/photo-selector",(function(n,a){return(a=a||{}).partials=a.partials?t.merge(l,a.partials):l,e(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-infinite-scroll-load-more",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,n,l){var r=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="infinite-scroll-load-more">\n\t<button class="alt">'+e.escapeExpression((r(t,"intlMessage")||a&&r(a,"intlMessage")||e.hooks.helperMissing).call(null!=a?a:e.nullContext||{},{name:"intlMessage",hash:{intlName:"common.LOAD_MORE_RESULTS"},data:l,loc:{start:{line:2,column:21},end:{line:2,column:72}}}))+"</button>\n</div>"},useData:!0}),n={};e.Array.each([],(function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)})),e.Template.register("hermes/infinite-scroll-load-more",(function(a,l){return(l=l||{}).partials=l.partials?e.merge(n,l.partials):n,t(a,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-license-detail",(function(e,a){var l=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,l,n,t){var s=null!=a?a:e.nullContext||{},r=e.hooks.helperMissing,i=e.escapeExpression,o=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<p class="secondary" style="margin-top: 0;">'+i((o(l,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:null!=a?o(a,"title"):a},data:t,loc:{start:{line:1,column:44},end:{line:1,column:74}}}))+'</p>\n<p class="secondary" style="margin-bottom: 0;">'+i((o(l,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:null!=a?o(a,"body"):a},data:t,loc:{start:{line:2,column:47},end:{line:2,column:76}}}))+"</p>\n"},useData:!0}),n={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)})),e.Template.register("hermes/license-detail",(function(a,t){return(t=t||{}).partials=t.partials?e.merge(n,t.partials):n,l(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});